---
import SiteLayout from "../layouts/SiteLayout.astro";
import { getCollection } from "astro:content";

// Prerender homepage as static
export const prerender = true;

// Canonical ordering for Creative Works section
const CANONICAL_ORDER = [
  'create-an-age-of-wonders',
  'perceptual-abundance',
  'access-is-everything',
  'energy-is-the-master-resource',
  'matter-is-programmable',
  'the-true-limits-of-computation',
  'infrastructure-replaces-empire',
  'why-we-dont-build',
  'the-builders-of-the-age-of-wonders',
  'political-economy-for-abundance',
  'the-free-starship',
  'the-solar-gravitational-lens',
];

const essays = (await getCollection("essays"))
  .filter(e => !e.data.draft)
  .sort((a, b) => {
    const indexA = CANONICAL_ORDER.indexOf(a.slug);
    const indexB = CANONICAL_ORDER.indexOf(b.slug);
    
    // If both are in canonical order, sort by that
    if (indexA !== -1 && indexB !== -1) {
      return indexA - indexB;
    }
    
    // If only one is in canonical order, it comes first
    if (indexA !== -1) return -1;
    if (indexB !== -1) return 1;
    
    // For any new essays not in canonical order, sort by date (most recent first)
    return b.data.date.getTime() - a.data.date.getTime();
  });
---

<SiteLayout title="Age of Wonders">
  <div style="max-width: 640px; margin-top: 32px;">
    <p style="font-size: 23px; line-height: 1.7; margin-bottom: 32px; color: var(--text);">
      Age of Wonders explores three ideas
    </p>

    <ol style="margin: 0 0 40px 0; padding-left: 28px; font-size: 21px; line-height: 1.8;">
      <li style="margin: 16px 0;">The universe is abundant beyond our wildest dreams.</li>
      <li style="margin: 16px 0;">We can create a future of wonders.</li>
      <li style="margin: 16px 0;">Access is everything.</li>
    </ol>

    <p style="font-size: 21px; font-style: italic; color: var(--muted); line-height: 1.7; padding-left: 24px; border-left: 2px solid #e0e0e0;">
      The sky isn't the limit. It's an infinite canvas.
    </p>
  </div>

  <hr style="margin: 72px 0;" />

  <h2 style="margin-bottom:16px;">Creative Works</h2>
  <p class="meta" style="margin-bottom:48px;">Each piece stands alone, but together they come together into a coherent vision for the future.</p>

  <ol class="creative-works-list">
    {essays.map((e, index) => (
      <li class="essay-card">
        <a href={`/essays/${e.slug}/`}>
          <span class="essay-number">{index + 1}</span>
          <div class="essay-content">
            <strong class="essay-title">{e.data.title}</strong>
            <span class="essay-description">{e.data.description}</span>
          </div>
        </a>
      </li>
    ))}
  </ol>

<style>
  .creative-works-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .creative-works-list .essay-card {
    padding: 24px 28px;
    margin: 16px 0;
    border-left: 2px solid #e0e0e0;
    background: linear-gradient(to right, rgba(245, 245, 245, 0.8), rgba(250, 250, 250, 0.3) 35%, transparent 60%);
    border-radius: 3px;
    transition: all 0.3s ease;
  }

  .creative-works-list .essay-card:hover {
    border-left-color: #a8c8e8;
    background: linear-gradient(to right, rgba(0, 102, 204, 0.035), rgba(0, 102, 204, 0.015) 35%, transparent 60%);
  }

  .creative-works-list .essay-card a {
    text-decoration: none;
    display: flex;
    align-items: flex-start;
    gap: 20px;
  }

  .essay-number {
    font-family: "Cormorant Garamond", serif;
    font-size: 15px;
    font-weight: 300;
    color: #d0d0d0;
    min-width: 20px;
    padding-top: 2px;
  }

  .essay-content {
    flex: 1;
  }

  .essay-title {
    font-size: 26px;
    display: block;
    color: var(--text);
    transition: color 0.2s ease;
    font-weight: 500;
    line-height: 1.3;
  }

  .essay-description {
    display: block;
    margin-top: 10px;
    color: var(--muted);
    font-size: 18px;
    line-height: 1.5;
  }

  @media (max-width: 640px) {
    .creative-works-list .essay-card {
      padding: 20px 22px;
      margin: 14px 0;
    }

    .creative-works-list .essay-card a {
      gap: 14px;
    }

    .essay-number {
      font-size: 14px;
      min-width: 18px;
      padding-top: 1px;
    }

    .essay-title {
      font-size: 22px;
    }

    .essay-description {
      font-size: 16px;
      margin-top: 8px;
    }
  }
</style>
</SiteLayout>
